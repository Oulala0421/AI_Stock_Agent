# 🤖 AI Stock Agent 自動更新設置指南 (Windows)

為了讓股票數據每天自動保持最新，您不需要每次手動執行腳本。您可以使用 Windows 內建的「工作排程器」來自動執行我們剛剛建立的 `run_daily_update.bat` 檔案。

## ⚡ 效能優化說明

**智慧增量更新 (Incremental Updates)**:
- **首次執行**: 抓取完整的 14 天歷史資料
- **每日更新**: 僅新增當天最新價格，並自動移除最舊的一天（保持 14 天滾動視窗）
- **優勢**: 
  - 減少 93% 的 API 請求（14天 → 1天）
  - 處理速度提升約 10 倍
  - 降低被 API 限流的風險

**自動偵測機制**:
- 如果資料超過 7 天未更新，會自動切換為完整更新
- 您也可以手動執行完整更新：`python scripts/update_daily.py --force-full`

## 方案 A: 手動一鍵更新
如果您想要隨時刷新數據：
1. 在資料夾中找到 **`run_daily_update.bat`**。
2. 點擊兩下執行。
3. 等待黑色視窗跑完並顯示 `Update Complete!`。
4. 重新整理網頁儀表板。

## 方案 B: 設定每日自動更新 (推薦)

### 步驟 1: 開啟工作排程器
1. 按下 `Win + S` 搜尋鍵。
2. 輸入 **"Task Scheduler"** 或 **"工作排程器"** 並開啟。

### 步驟 2: 建立工作
1. 在右側面板點擊 **"建立基本工作..." (Create Basic Task)**。
2. **名稱 (Name)**: 輸入 `AI Stock Agent Update`。
3. **觸發程序 (Trigger)**:選擇 **"每天" (Daily)**。
   - 設定時間: 建議設為股市收盤後，例如台灣時間 **05:00 AM** (冬令時間) 或 **04:00 AM** (夏令時間)，或乾脆設為 **07:00 AM** 確保數據都已結算。
4. **動作 (Action)**: 選擇 **"啟動程式" (Start a program)**。

### 步驟 3: 選擇腳本
1. **程式或指令碼 (Program/script)**: 點擊 "瀏覽"，選擇專案目錄下的 `run_daily_update.bat`。
   - 路徑: `c:\Users\willy\Documents\分析工具\AI_Stock_Agent\run_daily_update.bat`
2. **開始位置 (Start in)**: (重要！) 這裡請填入專案資料夾的路徑。
   - 填入: `c:\Users\willy\Documents\分析工具\AI_Stock_Agent\`
   - *注意: 如果沒填這個，腳本可能會因為找不到檔案而失敗。*

### 步驟 4: 完成
1. 點擊完成。
2. 您可以在清單中找到剛剛建立的工作，右鍵點擊選 **"執行" (Run)** 來測試一次。

---
**✅ 完成！** 現在您的 AI 助理會在您設定的時間自動起床抓資料，並且使用最優化的增量更新策略，既省時又省資源。
